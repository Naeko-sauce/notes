很好，下面我们来**深入理解 JavaScript 中“纯函数（Pure Function）”的概念**。这是函数式编程和代码可维护性中的重要思想之一。

---

## ✅ 一句话解释：

> **纯函数**：**相同的输入，一定返回相同的输出，且不依赖也不修改外部状态。**

---

## 🧠 更详细解释：

一个函数要称为“纯函数”，**必须同时满足两个条件**：

---

### 🔹 条件一：相同的输入 → 相同的输出（确定性）

- 函数的返回值只依赖它的参数
    
- 不依赖外部变量或环境
    

✅ 例子（纯函数）：

```js
function add(a, b) {
  return a + b;
}

add(1, 2); // 总是返回 3
```

❌ 非纯函数（返回值依赖外部变量）：

```js
let c = 10;
function add(a, b) {
  return a + b + c;
}
add(1, 2); // 结果会受外部变量 c 的影响
```

---

### 🔹 条件二：无副作用（不改变外部状态）

- 不修改全局变量
    
- 不修改传入的对象或数组
    
- 不输出 console、弹窗、改 DOM、发请求、写文件等副作用
    

✅ 例子（无副作用）：

```js
function square(x) {
  return x * x;
}
```

❌ 非纯函数（修改外部变量）：

```js
let total = 0;
function addToTotal(n) {
  total += n; // 改变了外部状态 total
}
```

---

## ✅ 总结纯函数的两大核心特征：

|特征|解释|
|---|---|
|1. 确定性输出|相同输入总是得到相同输出|
|2. 无副作用|不修改任何函数外部的变量或状态|

---

## 🔍 纯函数 VS 非纯函数 对比举例：

### 🔸 纯函数示例：

```js
function double(n) {
  return n * 2;
}
```

- ✅ 相同输入 `n`，总是输出 `n * 2`
    
- ✅ 没有修改外部任何变量或对象
    

---

### 🔸 非纯函数示例（副作用）：

```js
let count = 0;
function increment() {
  count++; // ❌ 修改了外部状态
}
```

---

### 🔸 非纯函数示例（依赖外部）：

```js
function getUserName() {
  return window.localStorage.getItem("username"); // ❌ 依赖外部环境
}
```

---

## ✅ 为什么使用纯函数？

纯函数的好处非常多：

| 好处        | 原因                         |
| --------- | -------------------------- |
| 可预测       | 相同输入 → 相同输出，不会出奇怪结果        |
| 易测试       | 不需要模拟全局变量、DOM、网络请求         |
| 可缓存（memo） | 因为输出确定，可以将结果缓存，提高性能        |
| 并行安全      | 不依赖外部状态，不会出现“两个函数抢一个变量”的问题 |
| 更可组合      | 多个纯函数可以自由组合，适合函数式编程        |

---

## 🔥 补充：常见副作用有哪些？

> 副作用就是函数除了“返回值”以外，还做了其他事。

常见副作用包括：

- 修改全局变量或对象
    
- 修改参数对象（传引用类型）
    
- 打印 `console.log()`
    
- 弹窗 `alert()`
    
- 改变 DOM
    
- 发网络请求
    
- 写文件/数据库
    
- 使用随机数或当前时间（不确定输出）
    

---

## ✅ 纯函数例子汇总（记住！）

```js
// 纯函数：确定 + 无副作用
function multiply(a, b) {
  return a * b;
}

// 非纯函数：有副作用（修改外部变量）
let count = 0;
function increase() {
  count++;
}

// 非纯函数：不确定性（Math.random）
function randomNum() {
  return Math.random();
}
```

---

## 📌 总结口诀：

```
纯函数有两宝：输入决定输出、别动外部跑
```

> ✅ 保证输入就是全部  
> ✅ 保证输出是唯一结果  
> ✅ 绝对不能改外部的变量、对象、数组、DOM、数据库等

---

需